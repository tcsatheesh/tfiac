Valid action: plan
market is grp
environment is npd
service is vnet
env_type is npd
Current working directory is /home/satheesh/projects/www.github.com/tcsatheesh/tfiac
Backend env file is /home/satheesh/projects/www.github.com/tcsatheesh/tfiac/variables/grp/prd/bed.env
TERRAFORM_BACKEND_AZURE_KEY is grp/npd/vnet.tfstate
Clearing terraform state
Running terraform init
[0m[1mInitializing the backend...[0m
[0m[32m
Successfully configured the backend "azurerm"! Terraform will automatically
use this backend unless the backend configuration changes.[0m
[0m[1mInitializing modules...[0m
- vnet in ../../modules/vnet
- vnet.aml in ../../modules/vnet/rulecollection/aml
- vnet.azuread in ../../modules/vnet/rulecollection/azuread
- vnet.buildsvr in ../../modules/vnet/rulecollection/buildsvr
- vnet.denyall in ../../modules/vnet/rulecollection/denyall
Downloading registry.terraform.io/Azure/avm-res-network-azurefirewall/azurerm 0.3.0 for vnet.firewall...
- vnet.firewall in .terraform/modules/vnet.firewall
Downloading registry.terraform.io/Azure/avm-res-network-publicipaddress/azurerm 0.2.0 for vnet.fw_managment_public_ip...
- vnet.fw_managment_public_ip in .terraform/modules/vnet.fw_managment_public_ip
Downloading registry.terraform.io/Azure/avm-res-network-publicipaddress/azurerm 0.2.0 for vnet.fw_public_ip...
- vnet.fw_public_ip in .terraform/modules/vnet.fw_public_ip
Downloading registry.terraform.io/Azure/avm-res-network-firewallpolicy/azurerm 0.3.3 for vnet.fwpolicy...
- vnet.fwpolicy in .terraform/modules/vnet.fwpolicy
Downloading registry.terraform.io/Azure/avm-res-network-networksecuritygroup/azurerm 0.4.0 for vnet.nsg...
- vnet.nsg in .terraform/modules/vnet.nsg
Downloading registry.terraform.io/Azure/avm-res-network-virtualnetwork/azurerm 0.8.1 for vnet.peering...
- vnet.peering in .terraform/modules/vnet.peering/modules/peering
Downloading registry.terraform.io/Azure/avm-res-network-virtualnetwork/azurerm 0.8.1 for vnet.subnets...
- vnet.subnets in .terraform/modules/vnet.subnets/modules/subnet
Downloading registry.terraform.io/Azure/avm-res-network-virtualnetwork/azurerm 0.8.1 for vnet.vnet...
- vnet.vnet in .terraform/modules/vnet.vnet
- vnet.vnet.peering in .terraform/modules/vnet.vnet/modules/peering
- vnet.vnet.subnet in .terraform/modules/vnet.vnet/modules/subnet
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/azurerm versions matching ">= 3.7.0, >= 3.71.0, >= 3.116.0, ~> 4.0, < 5.0.0"...
- Finding azure/modtm versions matching "~> 0.3"...
- Finding hashicorp/random versions matching ">= 3.5.0, ~> 3.5"...
- Finding azure/azapi versions matching ">= 1.13.0, < 3.0.0"...
- Installing hashicorp/azurerm v4.23.0...
- Installed hashicorp/azurerm v4.23.0 (signed by HashiCorp)
- Installing azure/modtm v0.3.5...
- Installed azure/modtm v0.3.5 (signed by a HashiCorp partner, key ID [0m[1m6F0B91BDE98478CF[0m[0m)
- Installing hashicorp/random v3.7.1...
- Installed hashicorp/random v3.7.1 (signed by HashiCorp)
- Installing azure/azapi v2.3.0...
- Installed azure/azapi v2.3.0 (signed by a HashiCorp partner, key ID [0m[1m6F0B91BDE98478CF[0m[0m)
Partner and community providers are signed by their developers.
If you'd like to know more about provider signing, you can read about it here:
https://www.terraform.io/docs/cli/plugins/signing.html
Terraform has created a lock file [1m.terraform.lock.hcl[0m to record the provider
selections it made above. Include this file in your version control repository
so that Terraform can guarantee to make the same selections by default when
you run "terraform init" in the future.[0m

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
Running terraform plan
[0m[1mmodule.vnet.azurerm_resource_group.this: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg][0m
[0m[1mmodule.vnet.module.fw_public_ip[0].azurerm_public_ip.this: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/publicIPAddresses/stc-genai-network-nonprod-vnet-firewall-ip][0m
[0m[1mmodule.vnet.module.vnet.data.azurerm_client_config.this: Reading...[0m[0m
[0m[1mmodule.vnet.azurerm_ip_group.this["portugal-pre-production-logicapp-subnets"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/ipGroups/portugal-pre-production-logicapp-subnets][0m
[0m[1mmodule.vnet.data.azurerm_ip_group.this["market-development-subnets"]: Reading...[0m[0m
[0m[1mmodule.vnet.module.fwpolicy[0].azurerm_firewall_policy.this: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/firewallPolicies/stc-genai-network-nonprod-vnet-firewall-policy][0m
[0m[1mmodule.vnet.module.fw_managment_public_ip[0].azurerm_public_ip.this: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/publicIPAddresses/stc-genai-network-nonprod-vnet-firewall-management-ip][0m
[0m[1mmodule.vnet.module.vnet.data.azurerm_client_config.this: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9OWNhY2E1YWQtZjg3Mi00NzFjLWFjMjktYzY1MGEzMjc4M2VlO3N1YnNjcmlwdGlvbklkPTg4M2M5MDgxLTIzZWQtNDY3NC05NWM1LTQ1Yzc0ODM0ZTA5Mzt0ZW5hbnRJZD1mMTZhYmUzOS0xMzlkLTRkNDYtOGQ2NC1mNzYyOWYwM2MyNWE=][0m
[0m[1mmodule.vnet.data.azurerm_ip_group.this["market-pre-production-subnets"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_ip_group.this["portugal-pre-production-logicapp-subnets"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_ip_group.this["pre-production-build-server"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_ip_group.this["group-api-management-subnet"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_ip_group.this["group-development-subnets"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_ip_group.this["market-development-subnets"]: Read complete after 1s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/ipGroups/market-development-subnets][0m
[0m[1mmodule.vnet.data.azurerm_ip_group.this["market-pre-production-subnets"]: Read complete after 1s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/ipGroups/market-pre-production-subnets][0m
[0m[1mmodule.vnet.data.azurerm_ip_group.this["group-pre-production-subnets"]: Reading...[0m[0m
[0m[1mmodule.vnet.azurerm_ip_group.this["pre-production-build-server"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/ipGroups/pre-production-build-server][0m
[0m[1mmodule.vnet.azurerm_ip_group.this["group-api-management-subnet"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/ipGroups/group-api-management-subnet][0m
[0m[1mmodule.vnet.data.azurerm_ip_group.this["group-development-subnets"]: Read complete after 0s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/ipGroups/group-development-subnets][0m
[0m[1mmodule.vnet.azurerm_ip_group.this["group-development-subnets"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/ipGroups/group-development-subnets][0m
[0m[1mmodule.vnet.data.azurerm_ip_group.this["portugal-pre-production-logicapp-subnets"]: Read complete after 0s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/ipGroups/portugal-pre-production-logicapp-subnets][0m
[0m[1mmodule.vnet.azurerm_ip_group.this["group-pre-production-subnets"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/ipGroups/group-pre-production-subnets][0m
[0m[1mmodule.vnet.data.azurerm_ip_group.this["group-api-management-subnet"]: Read complete after 0s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/ipGroups/group-api-management-subnet][0m
[0m[1mmodule.vnet.azurerm_ip_group.this["market-development-subnets"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/ipGroups/market-development-subnets][0m
[0m[1mmodule.vnet.data.azurerm_ip_group.this["pre-production-build-server"]: Read complete after 0s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/ipGroups/pre-production-build-server][0m
[0m[1mmodule.vnet.azurerm_ip_group.this["market-pre-production-subnets"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/ipGroups/market-pre-production-subnets][0m
[0m[1mmodule.vnet.data.azurerm_ip_group.this["group-pre-production-subnets"]: Read complete after 0s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/ipGroups/group-pre-production-subnets][0m
[0m[1mmodule.vnet.azurerm_route_table.this: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/routeTables/route-az-grp-firewall][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["website"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["sql"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["aiservices"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["containerregistry"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["sql"]: Read complete after 0s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.database.windows.net][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["website"]: Read complete after 0s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.azurewebsites.net][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["amlapi"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["cognitiveservices"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["keyvault"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["openai"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["blob"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["table"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["aiservices"]: Read complete after 0s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.services.ai.azure.com][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["file"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["keyvault"]: Read complete after 0s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["containerregistry"]: Read complete after 0s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["queue"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["managedredis"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["cognitiveservices"]: Read complete after 0s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.cognitiveservices.azure.com][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["amlnotebook"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["amlapi"]: Read complete after 0s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.api.azureml.ms][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["aisearch"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["table"]: Read complete after 0s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["enterpriseredis"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["openai"]: Read complete after 1s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.openai.azure.com][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["redis"]: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["file"]: Read complete after 1s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net][0m
[0m[1mmodule.vnet.module.vnet.azapi_resource.vnet: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/virtualNetworks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["blob"]: Read complete after 1s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_group.this: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["amlnotebook"]: Read complete after 1s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.notebooks.azure.net][0m
[0m[1mmodule.vnet.module.nsg["firewall"].azurerm_network_security_group.this: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/firewall-nsg][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["managedredis"]: Read complete after 1s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.redis.azure.net][0m
[0m[1mmodule.vnet.module.nsg["firewall-mgmt"].azurerm_network_security_group.this: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/firewall-mgmt-nsg][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["enterpriseredis"]: Read complete after 1s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.redisenterprise.cache.azure.net][0m
[0m[1mmodule.vnet.module.nsg["pre-production"].azurerm_network_security_group.this: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/pre-nsg][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["queue"]: Read complete after 1s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net][0m
[0m[1mmodule.vnet.module.nsg["development"].azurerm_network_security_group.this: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/dev-nsg][0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["aisearch"]: Read complete after 1s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.aisearch.windows.net][0m
[0m[1mmodule.vnet.data.azurerm_log_analytics_workspace.this: Reading...[0m[0m
[0m[1mmodule.vnet.data.azurerm_private_dns_zone.this["redis"]: Read complete after 0s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.redis.cache.windows.net][0m
[0m[1mmodule.vnet.data.azurerm_log_analytics_workspace.this: Read complete after 0s [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-logging-nonprod-rg/providers/Microsoft.OperationalInsights/workspaces/stc-genai-logging-nopnprod-lgn][0m
[0m[1mmodule.vnet.module.vnet.azurerm_monitor_diagnostic_setting.this["sendToLogAnalytics"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/virtualNetworks/stc-genai-network-nonprod-vnet|sendToLogAnalytics][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["keyvault"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["file"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["website"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.azurewebsites.net/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["aiservices"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.services.ai.azure.com/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["blob"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["openai"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.openai.azure.com/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["aisearch"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.aisearch.windows.net/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["managedredis"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.redis.azure.net/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["amlapi"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.api.azureml.ms/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["amlnotebook"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.notebooks.azure.net/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["redis"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.redis.cache.windows.net/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["table"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["cognitiveservices"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.cognitiveservices.azure.com/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["containerregistry"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.azurecr.io/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["sql"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.database.windows.net/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["queue"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.azurerm_private_dns_zone_virtual_network_link.this["enterpriseredis"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-dns-prod-rg/providers/Microsoft.Network/privateDnsZones/privatelink.redisenterprise.cache.azure.net/virtualNetworkLinks/stc-genai-network-nonprod-vnet][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_rule.this["rule15"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg/securityRules/Access_KeyVault][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_rule.this["rule01"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg/securityRules/Management_endpoint_for_Azure_portal_and_Powershell][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_rule.this["rule10"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg/securityRules/Publish_DiagnosticLogs_And_Metrics][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_rule.this["rule09"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg/securityRules/Azure_Infrastructure_Load_Balancer][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_rule.this["rule07"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg/securityRules/Dependency_To_sync_RateLimit_Outbound][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_rule.this["rule02"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg/securityRules/Dependency_on_Redis_Cache][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_rule.this["rule11"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg/securityRules/Connect_To_SMTP_Relay_For_SendingEmails][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_rule.this["rule05"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg/securityRules/Dependency_for_Log_to_event_Hub_policy][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_rule.this["rule13"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg/securityRules/Dependency_on_Azure_Storage][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_rule.this["rule08"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg/securityRules/Dependency_on_Azure_File_Share_for_GIT][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_rule.this["rule12"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg/securityRules/Authenticate_To_Azure_Active_Directory][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_rule.this["rule14"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg/securityRules/Publish_Monitoring_Logs][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_rule.this["rule06"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg/securityRules/Dependency_on_Redis_Cache_outbound][0m
[0m[1mmodule.vnet.module.nsg["development"].azurerm_network_security_rule.this["rule01"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/dev-nsg/securityRules/test-rule][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_rule.this["rule04"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg/securityRules/Dependency_on_Azure_SQL][0m
[0m[1mmodule.vnet.module.nsg["api-management"].azurerm_network_security_rule.this["rule03"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/networkSecurityGroups/api-nsg/securityRules/Dependency_to_sync_Rate_Limit_Inbound][0m
[0m[1mmodule.vnet.module.subnets["api-management"].azapi_resource.subnet: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/virtualNetworks/stc-genai-network-nonprod-vnet/subnets/ApiManagementSubnet][0m
[0m[1mmodule.vnet.module.subnets["firewall-mgmt"].azapi_resource.subnet: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/virtualNetworks/stc-genai-network-nonprod-vnet/subnets/AzureFirewallManagementSubnet][0m
[0m[1mmodule.vnet.module.subnets["firewall"].azapi_resource.subnet: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/virtualNetworks/stc-genai-network-nonprod-vnet/subnets/AzureFirewallSubnet][0m
[0m[1mmodule.vnet.module.subnets["pre-production"].azapi_resource.subnet: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/virtualNetworks/stc-genai-network-nonprod-vnet/subnets/PreProductionSubnet][0m
[0m[1mmodule.vnet.module.subnets["development"].azapi_resource.subnet: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/virtualNetworks/stc-genai-network-nonprod-vnet/subnets/DevelopmentSubnet][0m
[0m[1mmodule.vnet.module.firewall[0].azurerm_firewall.this: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/azureFirewalls/stc-genai-network-nonprod-vnet-firewall][0m
[0m[1mmodule.vnet.module.firewall[0].azurerm_monitor_diagnostic_setting.this["to_law"]: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/azureFirewalls/stc-genai-network-nonprod-vnet-firewall|diag][0m
[0m[1mmodule.vnet.module.azuread.azurerm_firewall_policy_rule_collection_group.this: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/firewallPolicies/stc-genai-network-nonprod-vnet-firewall-policy/ruleCollectionGroups/AzureActiveDirectoryCollectionGroup][0m
[0m[1mmodule.vnet.module.aml.azurerm_firewall_policy_rule_collection_group.this: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/firewallPolicies/stc-genai-network-nonprod-vnet-firewall-policy/ruleCollectionGroups/AzureMachineLearningCollectionGroup][0m
[0m[1mmodule.vnet.module.buildsvr.azurerm_firewall_policy_rule_collection_group.this: Refreshing state... [id=/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/firewallPolicies/stc-genai-network-nonprod-vnet-firewall-policy/ruleCollectionGroups/AzureBuildServerCollectionGroup][0m

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # module.vnet.module.denyall.azurerm_firewall_policy_rule_collection_group.this[0m will be created
[0m  [32m+[0m[0m resource "azurerm_firewall_policy_rule_collection_group" "this" {
      [32m+[0m[0m firewall_policy_id = "/subscriptions/883c9081-23ed-4674-95c5-45c74834e093/resourceGroups/stc-genai-network-nonprod-rg/providers/Microsoft.Network/firewallPolicies/stc-genai-network-nonprod-vnet-firewall-policy"
      [32m+[0m[0m id                 = (known after apply)
      [32m+[0m[0m name               = "DenyAllInternetCollectionGroup"
      [32m+[0m[0m priority           = 500

      [32m+[0m[0m network_rule_collection {
          [32m+[0m[0m action   = "Deny"
          [32m+[0m[0m name     = "deny-allinternet"
          [32m+[0m[0m priority = 20000

          [32m+[0m[0m rule {
              [32m+[0m[0m destination_addresses = [
                  [32m+[0m[0m "Internet",
                ]
              [32m+[0m[0m destination_ports     = [
                  [32m+[0m[0m "*",
                ]
              [32m+[0m[0m name                  = "denyAll"
              [32m+[0m[0m protocols             = [
                  [32m+[0m[0m "TCP",
                  [32m+[0m[0m "UDP",
                ]
              [32m+[0m[0m source_addresses      = [
                  [32m+[0m[0m "*",
                ]
            }
        }
    }

[1mPlan:[0m 1 to add, 0 to change, 0 to destroy.
[0m[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Note: You didn't use the -out option to save this plan, so Terraform can't
guarantee to take exactly these actions if you run "terraform apply" now.
